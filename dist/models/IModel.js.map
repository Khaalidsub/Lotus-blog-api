{"version":3,"file":"IModel.js","sourceRoot":"","sources":["../../src/models/IModel.ts"],"names":[],"mappings":";;;AAOA,SAAgB,qBAAqB,CAAC,MAAc;IAClD,IAAI,KAAK,GAAG,EAAE,CAAC;IAEf,gCAAgC;IAChC,MAAM,CAAC,QAAQ,CAAC,SAAS,OAAO,CAAC,QAAgB,EAAE,UAAe;QAChE,qDAAqD;QACrD,IAAI,QAAQ,IAAI,KAAK;YAAE,OAAO;QAC9B,kFAAkF;QAClF,4DAA4D;QAC5D,IAAI,UAAU,CAAC,OAAO,CAAC,GAAG;YAAE,KAAK,IAAI,GAAG,GAAG,QAAQ,CAAC;IACtD,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;IAC5B,MAAM,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;IAC/B,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;IAChC,mFAAmF;IACnF,mCAAmC;IACnC,SAAS,OAAO,CAAC,IAAS;QACxB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QACrB,IAAI,EAAE,CAAC;IACT,CAAC;AACH,CAAC;AArBD,sDAqBC","sourcesContent":["import {$log} from \"@tsed/common\";\r\nimport {Mongoose, Schema, SchemaType} from \"mongoose\";\r\n\r\nexport interface IModel {\r\n  _id: String;\r\n}\r\n\r\nexport function autoPopulateAllFields(schema: Schema) {\r\n  var paths = \"\";\r\n\r\n  //checks every schema field path\r\n  schema.eachPath(function process(pathname: string, schemaType: any) {\r\n    //if path is the id of the document, no need to check\r\n    if (pathname == \"_id\") return;\r\n    // if (pathname === \"likedPosts\") $log.info(\"YOOO\", schemaType.options, pathname);\r\n    //if the field path has an option \"ref\", add it in the paths\r\n    if (schemaType.options.ref) paths += \" \" + pathname;\r\n  });\r\n\r\n  schema.pre(\"find\", handler);\r\n  schema.pre(\"findOne\", handler);\r\n  schema.pre(\"findById\", handler);\r\n  //acts like a loop, it will populate all the field paths that have the option \"ref\"\r\n  //TODO : fix the password for users\r\n  function handler(next: any) {\r\n    this.populate(paths);\r\n    next();\r\n  }\r\n}\r\n"]}