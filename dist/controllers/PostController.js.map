{"version":3,"file":"PostController.js","sourceRoot":"","sources":["../../src/controllers/PostController.ts"],"names":[],"mappings":";;;;AAAA,yCAAoH;AACpH,yCAA6C;AAC7C,yDAAoD;AACpD,6CAAuD;AACvD,yCAAoC;AAGpC,IAAa,cAAc,GAA3B,MAAa,cAAc;IACzB,YAAyC,OAAoB;QAApB,YAAO,GAAP,OAAO,CAAa;IAAG,CAAC;IAE3D,MAAM;;YACV,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAE1C,OAAO,KAAK,CAAC;QACf,CAAC;KAAA;IACD,+BAA+B;IAGzB,YAAY,CAAc,GAAS;;YACvC,aAAI,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;YAC1B,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAC,IAAI,EAAE,GAAG,CAAC,GAAG,EAAC,CAAC,CAAC;YAEvD,OAAO,KAAK,CAAC;QACf,CAAC;KAAA;IACD,+BAA+B;IAEzB,eAAe,CAAmB,EAAU;;YAChD,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAC,IAAI,EAAE,EAAE,EAAC,CAAC,CAAC;YAElD,OAAO,KAAK,CAAC;QACf,CAAC;KAAA;IAEK,GAAG,CAAmB,EAAU;;YACpC,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC7C,OAAO,IAAI,CAAC;QACd,CAAC;KAAA;IAIK,GAAG,CAAqB,IAAW,EAAe,GAAS;;YAC/D,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC;YACpB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAC7C,OAAO,OAAO,CAAC;QACjB,CAAC;KAAA;IAIK,UAAU,CAAqB,IAAW;;YAC9C,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAC1C,OAAO,UAAU,CAAC;QACpB,CAAC;KAAA;IAGK,MAAM,CAAmB,EAAU;;YACvC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC/C,OAAO,QAAQ,CAAC;QAClB,CAAC;KAAA;CACF,CAAA;AA/CC;IADC,YAAG,EAAE;;;;4CAKL;AAID;IAFC,YAAG,CAAC,WAAW,CAAC;IAChB,oBAAS,CAAC,OAAO,CAAC;IACC,mBAAA,YAAG,CAAC,MAAM,CAAC,CAAA;;6CAAM,WAAI;;kDAKxC;AAGD;IADC,YAAG,CAAC,iBAAiB,CAAC;IACA,mBAAA,mBAAU,CAAC,IAAI,CAAC,CAAA;;6CAAK,MAAM;;qDAIjD;AAED;IADC,YAAG,CAAC,WAAW,CAAC;IACN,mBAAA,mBAAU,CAAC,IAAI,CAAC,CAAA;;6CAAK,MAAM;;yCAGrC;AAID;IAFC,aAAI,EAAE;IACN,oBAAS,CAAC,OAAO,CAAC;IACR,mBAAA,mBAAU,CAAC,MAAM,CAAC,CAAA,EAAe,mBAAA,YAAG,CAAC,MAAM,CAAC,CAAA;;6CAAnB,WAAK,EAAoB,WAAI;;yCAIhE;AAID;IAFC,YAAG,CAAC,SAAS,CAAC;IACd,oBAAS,CAAC,OAAO,CAAC;IACD,mBAAA,mBAAU,CAAC,MAAM,CAAC,CAAA;;6CAAO,WAAK;;gDAG/C;AAGD;IAFC,eAAM,CAAC,WAAW,CAAC;IACnB,oBAAS,CAAC,OAAO,CAAC;IACL,mBAAA,mBAAU,CAAC,IAAI,CAAC,CAAA;;6CAAK,MAAM;;4CAGxC;AAjDU,cAAc;IAD1B,mBAAU,CAAC,QAAQ,CAAC;IAEN,mBAAA,eAAM,CAAC,yBAAW,CAAC,CAAA;6CAAkB,yBAAW;GADlD,cAAc,CAkD1B;AAlDY,wCAAc","sourcesContent":["import {Controller, Get, Post, Inject, PathParams, BodyParams, Delete, $log, Session, Req, Put} from \"@tsed/common\";\r\nimport {Post as Posts} from \"../models/Post\";\r\nimport {PostService} from \"../services/PostService\";\r\nimport {Authorize, Authenticate} from \"@tsed/passport\";\r\nimport {User} from \"../models/User\";\r\n\r\n@Controller(\"/posts\")\r\nexport class PostController {\r\n  constructor(@Inject(PostService) private service: PostService) {}\r\n  @Get()\r\n  async getAll() {\r\n    const posts = await this.service.find({});\r\n\r\n    return posts;\r\n  }\r\n  //get posts of the logged  user\r\n  @Get(\"/my-posts\")\r\n  @Authorize(\"basic\")\r\n  async getUserPosts(@Req(\"user\") req: User) {\r\n    $log.info(\"session\", req);\r\n    const posts = await this.service.find({user: req._id});\r\n\r\n    return posts;\r\n  }\r\n  //get the posts of another user\r\n  @Get(\"/user-posts/:id\")\r\n  async getProfilePosts(@PathParams(\"id\") id: String) {\r\n    const posts = await this.service.find({user: id});\r\n\r\n    return posts;\r\n  }\r\n  @Get(\"/post/:id\")\r\n  async get(@PathParams(\"id\") id: String) {\r\n    const post = await this.service.findById(id);\r\n    return post;\r\n  }\r\n\r\n  @Post()\r\n  @Authorize(\"basic\")\r\n  async add(@BodyParams(\"post\") post: Posts, @Req(\"user\") req: User) {\r\n    post.user = req._id;\r\n    const newPost = await this.service.add(post);\r\n    return newPost;\r\n  }\r\n\r\n  @Put(\"/update\")\r\n  @Authorize(\"basic\")\r\n  async updatePost(@BodyParams(\"post\") post: Posts) {\r\n    const updatePost = this.service.set(post);\r\n    return updatePost;\r\n  }\r\n  @Delete(\"/post/:id\")\r\n  @Authorize(\"basic\")\r\n  async delete(@PathParams(\"id\") id: String) {\r\n    const response = await this.service.delete(id);\r\n    return response;\r\n  }\r\n}\r\n"]}